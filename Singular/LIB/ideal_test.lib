//this will be the ideal test thingi

proc compIds(ideal I1, ideal I2)
"
"
{
 int i1,i2,t;
 poly p;
 list R;
 ideal It;
 for (i1 = 1; i1 <= size(I1); i1++)
 {
  p = I1[i1];
  for (i2 = 1; i2 <= size(I2); i2++)
  {
   if (p==I2[i2]) {t = 1; break;}
  }
  if (t == 0) {It[size(It)+1] = p;}
  else {t = 0;}
 }
 R[1] = It;
 kill It; ideal It;
 

 
 for (i2 = 1; i2 <= size(I2); i2++)
 {
  p = I2[i2];
  for (i1 = 1; i1 <= size(I1); i1++)
  {
   if (p==I1[i1]) {t = 1; break;}
  }
  if (t == 0) {It[size(It)+1] = p;}
  else {t = 0;}
 }
 R[2] = It;
 

 return(R);
}

proc lpGbVs(ideal I)
"
"
{
 ideal I1; ideal I2;
 list R;
 I1 = letplaceGBasis(I);
 I2 = system("freegbdvc",I,attrib(basering,"uptodeg"), attrib(basering,"lV"));
 R = compIds(I1,I2);
 return(R);
}

proc itProc(list L)
"
"
{
 int i;
 list R;
 for (i=1; i <= size(L); i++)
 {
  R[size(R)+1] = lpGbVs(L[i]);
 }

 return(R);
}


/*
test:

LIB "freegb.lib";
ring r = 0,(x,y),dp;
def R = makeLetterplaceRing(10);
setring R;
ideal I = x(1)*x(2) + x(1)*y(2),y(1)*x(2);




*/

proc deHomogLpIdeal(ideal I, int d, int i)
"USAGE: deHomogLpIdeal(I, i); I a Letterplace ideal, d,i Integers
RETURN:Ideal, where some Variables are replace by 1 (see PURPOSE)
PURPOSE: Dehomogenize an Ideal. i should be the index, with 
respect to the ordering of the current active ring, of the Variable 
in the Base ring we want to replace by 1 in the Letterplace ring.
d should be the number of variables in the base ring.
"
{
  i = i % d;
  list L=maxideal(1);
  int j;
  for(j=1; j<=size(L[1]); j=j+1){if(j % d == i) {L[1][j] = 1;}}
  map f=basering,L[1];
  return(simplify(f(I),2));
}
example
{
  "EXAMPLE:"; echo = 2;
  LIB "freegb.lib";
  ring r = 0,(a,x,y),dp;
  def R = makeLetterplaceRing(10);
  setring R;
  ideal I =  x(1)*x(2) + x(1)*y(2),
             x(1)*y(2)*y(3) + x(1)*x(2)*a(3),
             a(1)*x(2) - x(2)*a(1);
  deHomogLpIdeal(I,3,1);
}
